
<div class="max-w-7xl mx-auto pb-12">
    <header class="mb-10">
        <h1 class="text-4xl font-black text-slate-900 dark:text-white tracking-tight mb-2">贡献问题词条</h1>
        <p class="text-lg text-slate-500 dark:text-slate-400">沉淀技术经验，帮助团队快速脱坑。填写下方表单自动生成标准 Markdown。</p>
    </header>

    <div class="flex flex-col xl:flex-row gap-8">
        <!-- Form Section -->
        <div class="xl:w-3/5">
            <form [formGroup]="faqForm" class="space-y-6">
                
                <!-- Basic Info Card -->
                <div class="bg-white/80 dark:bg-slate-800/50 backdrop-blur border border-slate-200 dark:border-slate-700 rounded-xl p-6 shadow-lg transition-colors duration-300">
                    <h2 class="text-lg font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-wide mb-6 border-b border-slate-100 dark:border-slate-700 pb-2">基本信息</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label for="title" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">标题 (问题简述) <span class="text-red-500">*</span></label>
                            <input type="text" id="title" formControlName="title" placeholder="例如：异步校验失败导致死循环" class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="component" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">所属模块 <span class="text-red-500">*</span></label>
                                <select id="component" formControlName="component" class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                                    <option>Form</option>
                                    <option>Table</option>
                                    <option>Project</option>
                                    <option>Backend</option>
                                </select>
                            </div>
                            <div>
                                <label for="version" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">影响版本 <span class="text-red-500">*</span></label>
                                <input type="text" id="version" formControlName="version" placeholder="例如 1.2.x" class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="tags" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">标签 (逗号分隔) <span class="text-red-500">*</span></label>
                                <input type="text" id="tags" formControlName="tags" placeholder="Tag1, Tag2" class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                            </div>
                             <div>
                                <label for="errorCode" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">错误码 (可选)</label>
                                <input type="text" id="errorCode" formControlName="errorCode" placeholder="后端返回的 Error Code" class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Card -->
                <div class="bg-white/80 dark:bg-slate-800/50 backdrop-blur border border-slate-200 dark:border-slate-700 rounded-xl p-6 shadow-lg transition-colors duration-300">
                     <h2 class="text-lg font-bold text-pink-600 dark:text-pink-400 uppercase tracking-wide mb-6 border-b border-slate-100 dark:border-slate-700 pb-2">详细内容</h2>
                     <div class="space-y-6">
                        <div>
                            <label for="phenomenon" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">问题现象 <span class="text-red-500">*</span></label>
                            <textarea id="phenomenon" formControlName="phenomenon" rows="4" placeholder="详细描述复现步骤、控制台报错信息等..." class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"></textarea>
                        </div>
                         <div>
                            <label for="solution" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">解决方案 <span class="text-red-500">*</span></label>
                            <textarea id="solution" formControlName="solution" rows="4" placeholder="根本原因分析及修复步骤..." class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"></textarea>
                        </div>
                     </div>
                </div>

                <!-- Technical Card -->
                <div class="bg-white/80 dark:bg-slate-800/50 backdrop-blur border border-slate-200 dark:border-slate-700 rounded-xl p-6 shadow-lg transition-colors duration-300">
                     <h2 class="text-lg font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-wide mb-6 border-b border-slate-100 dark:border-slate-700 pb-2">排查与验证</h2>
                     <div class="space-y-6">
                        <div>
                            <label for="troubleshootingFlow" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">排查流程图 (Mermaid) <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <textarea id="troubleshootingFlow" formControlName="troubleshootingFlow" rows="6" class="font-mono text-sm block w-full bg-slate-100 dark:bg-slate-950 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-emerald-600 dark:text-green-400 focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"></textarea>
                                <div class="absolute top-2 right-2 text-xs text-slate-400 pointer-events-none">Mermaid Syntax</div>
                            </div>
                        </div>
                        <div>
                            <label for="validationMethod" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1">验证方法 <span class="text-red-500">*</span></label>
                            <textarea id="validationMethod" formControlName="validationMethod" rows="3" placeholder="如何确认问题已修复..." class="block w-full bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"></textarea>
                        </div>
                     </div>
                </div>
            </form>
        </div>

        <!-- Preview & Output Section (Sticky) -->
        <div class="xl:w-2/5">
            <div class="sticky top-6 space-y-4 h-[calc(100vh-2rem)] flex flex-col">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-bold text-slate-900 dark:text-white">生成结果</h2>
                    <span [class]="faqForm.valid ? 'text-emerald-600 dark:text-emerald-400 bg-emerald-100 dark:bg-emerald-900/30 border-emerald-200 dark:border-emerald-800' : 'text-amber-600 dark:text-amber-400 bg-amber-100 dark:bg-amber-900/30 border-amber-200 dark:border-amber-800'" class="text-xs font-bold px-2 py-1 rounded border uppercase">
                        {{ faqForm.valid ? '校验通过' : '填写未完成' }}
                    </span>
                </div>
                
                <div class="relative flex-1 bg-slate-100 dark:bg-slate-950 rounded-xl border border-slate-300 dark:border-slate-700 shadow-2xl overflow-hidden flex flex-col transition-colors duration-300">
                    <div class="absolute top-0 left-0 right-0 h-8 bg-slate-200 dark:bg-slate-900 border-b border-slate-300 dark:border-slate-800 flex items-center px-3 gap-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    
                    <div class="flex-1 overflow-auto p-4 pt-10">
                         <pre class="font-mono text-xs md:text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap">{{ faqForm.valid ? generatedMarkdown() : '// 请完善左侧必填信息...' }}</pre>
                    </div>

                    <div class="p-4 bg-slate-200 dark:bg-slate-900 border-t border-slate-300 dark:border-slate-800">
                        <button (click)="copyToClipboard()" [disabled]="!faqForm.valid" 
                            [class]="copied() ? 'bg-emerald-500 hover:bg-emerald-600' : 'bg-indigo-600 hover:bg-indigo-700'"
                            class="w-full py-3 rounded-lg font-bold text-white transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                            @if(copied()){
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                <span>已复制到剪贴板</span>
                            } @else {
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" /><path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" /></svg>
                                <span>复制 Markdown</span>
                            }
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
